<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- Acción de reporte PDF para agent.receipt -->
    <record id="action_report_agent_receipt" model="ir.actions.report">
        <field name="name">Boleta Agente Multibanco</field>
        <field name="model">agent.receipt</field>
        <field name="report_type">qweb-pdf</field>
        <!-- nombre técnico del template qweb -->
        <field name="report_name">moduloagentebl.report_agent_receipt</field>
        <field name="report_file">moduloagentebl.report_agent_receipt</field>
        <field name="print_report_name">
            (object.name or 'Boleta').replace('/', '_')
        </field>
        <!-- Guarda el PDF en la bdd como adjunto la primera vez -->
        <field name="attachment_use">True</field>
        <field name="attachment">
            (object.name or 'Boleta').replace('/', '_') + '.pdf'
        </field>
    </record>

    <!-- Template QWeb del PDF -->
    <template id="report_agent_receipt">
        <t t-call="web.basic_layout">
            <t t-foreach="docs" t-as="o">
                <div class="page">
                    <h2 style="text-align:center;">
                        Agente Multibanco B&amp;L
                    </h2>

                    <p style="text-align:center; font-size:12px;">
                        <t t-esc="o.company_id.name or 'Mi Empresa'"/>
                    </p>

                    <hr/>

                    <p>
                        <strong>Boleta:</strong>
                        <t t-esc="o.name or 'Nuevo'"/>
                    </p>
                    <p>
                        <strong>Fecha:</strong>
                        <t t-esc="o.date"/>
                    </p>
                    <p>
                        <strong>Operador:</strong>
                        <t t-esc="o.operator_id.name"/>
                    </p>

                    <hr/>

                    <p>
                        <strong>Banco / Red:</strong>
                        <t t-esc="o.bank"/>
                    </p>
                    <p>
                        <strong>Tipo de movimiento:</strong>
                        <t t-esc="o.movement"/>
                    </p>
                    <p>
                        <strong>N° cuenta / N° celular:</strong>
                        <t t-esc="o.account or ''"/>
                    </p>

                    <hr/>

                    <p><strong>Solicitante</strong></p>
                    <p>
                        DNI:
                        <t t-esc="o.solicitante_dni or ''"/>
                    </p>
                    <p>
                        Nombre:
                        <t t-esc="o.solicitante_nombre or ''"/>
                    </p>

                    <p><strong>Beneficiario</strong></p>
                    <p>
                        DNI:
                        <t t-esc="o.beneficiario_dni or ''"/>
                    </p>
                    <p>
                        Nombre:
                        <t t-esc="o.beneficiario_nombre or ''"/>
                    </p>

                    <hr/>

                    <p>
                        <strong>Monto:</strong>
                        S/ <t t-esc="format_lang(o.amount, currency_obj=o.currency_id)"/>
                    </p>
                    <p>
                        <strong>Comisión:</strong>
                        S/ <t t-esc="format_lang(o.fee, currency_obj=o.currency_id)"/>
                    </p>
                    <p>
                        <strong>Total:</strong>
                        S/ <t t-esc="format_lang(o.total, currency_obj=o.currency_id)"/>
                    </p>

                    <hr/>

                    <p style="font-size:10px; text-align:center;">
                        Gracias por su operación.
                    </p>
                </div>
            </t>
        </t>
    </template>

</odoo>
