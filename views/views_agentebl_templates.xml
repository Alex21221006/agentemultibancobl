<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- P√°gina principal del Agente Multibanco B&L -->
    <template id="agente_bl_page"
              name="Agente Multibanco B&amp;L"
              page="True">

        <!-- Usamos el layout est√°ndar de Odoo, sin modificarlo -->
       <t t-call="website.layout">


            <!-- T√≠tulo de la pesta√±a -->
            <t t-set="title">Agente Multibanco B&amp;L</t>

            <main id="agente-multibanco-bl">

                <!-- ===========================
                     LOGIN
                     =========================== -->
                <section id="loginView" class="view center">
                    <div class="card login">
                        <h1 class="brand">Agente B&amp;L</h1>
                        <p class="muted">Acceso exclusivo del personal autorizado</p>

                        <form id="loginForm" autocomplete="on">
                            <label>Usuario
                                <input type="text" id="lgUser" placeholder="ManuelBL" required="required"/>
                            </label>

                            <label>Contrase√±a
                                <input type="password" id="lgPass" placeholder="12345678" required="required"/>
                            </label>

                            <div class="remember-row">
                                <label class="check">
                                    <input type="checkbox" id="rememberUser"/> Recordar usuario
                                </label>

                                <label class="check">
                                    <input type="checkbox" id="rememberPass"/> Recordar contrase√±a
                                </label>
                            </div>

                            <button class="btn primary" type="submit">Iniciar sesi√≥n</button>
                        </form>

                        <!-- Enlace para entrar al panel Odoo REAL -->
                        <div class="admin-link" style="margin-top: 16px; text-align: center;">
                            <a href="/web/login?redirect=/web"
                               target="_blank"
                               style="color:#00e0ff; text-decoration:underline; font-size:0.9rem;">
                                ‚Üê Ingresar al panel Odoo (administrador)
                            </a>
                        </div>

                    </div>
                </section>

                <!-- ===========================
                     APLICACI√ìN
                     =========================== -->
                <section id="appView" class="view hidden">

                    <!-- Topbar -->
                    <header class="topbar">
                        <div class="left">
                            <span class="logo">B&amp;L</span>
                            <span class="title">Panel de Agente Multibanco</span>
                        </div>
                        <div class="right">
                            <button id="btnAgent" class="chip active">Mi agente</button>
                            <button id="btnReceipts" class="chip">Mis recibos</button>
                            <div class="divider"></div>
                            <button id="btnLogout" class="chip warn">Salir</button>
                        </div>
                    </header>

                    <!-- MI AGENTE -->
                    <main id="agentView">
                        <div class="card op-card">
                            <h2>Operaci√≥n</h2>

                            <!-- DOS COLUMNAS -->
                            <div class="grid two">

                                <!-- IZQUIERDA -->
                                <div class="col-left">

                                    <label for="bank">Banco / Red</label>
                                    <select id="bank" required="required">
                                        <option value="">‚Äî Seleccione ‚Äî</option>
                                        <option>BCP</option>
                                        <option>INTERBANK</option>
                                        <option>BBVA</option>
                                        <option>SCOTIABANK</option>
                                        <option>CAJA AREQUIPA</option>
                                        <option>CAJA CUSCO</option>
                                        <option>BANCO DE LA NACION</option>
                                        <option>YAPE</option>
                                        <option>PLIN</option>
                                        <option>BIM</option>
                                        <option>KASNET</option>
                                        <option>PAGAYA</option>
                                        <option>BITEL</option>
                                        <option>ENTEL</option>
                                        <option>MOVISTAR</option>
                                        <option>CLARO</option>
                                        <option>AZULITO</option>
                                    </select>

                                    <label for="movement">Tipo de movimiento</label>
                                    <select id="movement" required="required">
                                        <option value="">‚Äî Seleccione ‚Äî</option>
                                        <option>Dep√≥sito</option>
                                        <option>Retiro</option>
                                        <option>Giro</option>
                                        <option>Pago</option>
                                        <option>Recarga</option>
                                    </select>

                                    <!-- Solicitante -->
                                    <div class="field-row">
                                        <label for="dniSolicitante">DNI del solicitante</label>
                                        <div class="input-action">
                                            <input id="dniSolicitante" type="text" inputmode="numeric"
                                                   maxlength="8" placeholder="Ej: 12345678"/>
                                            <button type="button" class="btn-icon dni-lookup"
                                                    data-target="dniSolicitante">üîé
                                            </button>
                                        </div>
                                    </div>

                                    <!-- Beneficiario -->
                                    <div class="field-row">
                                        <label for="dniBeneficiario">DNI del beneficiario</label>
                                        <div class="input-action">
                                            <input id="dniBeneficiario" type="text" inputmode="numeric"
                                                   maxlength="8" placeholder="Ej: 87654321"/>
                                            <button type="button" class="btn-icon dni-lookup"
                                                    data-target="dniBeneficiario">üîé
                                            </button>
                                        </div>
                                    </div>

                                    <label for="account">N¬∞ cuenta / N¬∞ celular</label>
                                    <input type="text" id="account" placeholder="Cuenta / Celular"/>

                                    <label for="description">Descripci√≥n</label>
                                    <input list="descList" id="description"
                                           placeholder="Escribe y guarda; aprender√° sugerencias"/>
                                    <datalist id="descList"></datalist>
                                    <small class="muted">Ej.: AVON, AZZORTI, SANTANDER, etc.</small>

                                    <div class="grid two tight">
                                        <div>
                                            <label for="amount">Monto (S/)</label>
                                            <input type="number" id="amount" min="0" step="1" placeholder="0"/>
                                        </div>
                                        <div>
                                            <label for="fee">Comisi√≥n (S/)</label>
                                            <input type="number" id="fee" min="0" step="0.01"/>
                                            <small class="muted">Puedes editar para aplicar descuento.</small>
                                        </div>
                                    </div>

                                    <label for="total">Total (S/)</label>
                                    <input type="number" id="total" readonly="readonly"/>

                                    <div class="actions">
                                        <button class="btn" id="btnClear" type="reset">Limpiar</button>
                                        <button class="btn primary" id="btnSave" type="button">
                                            Guardar y generar boleta
                                        </button>
                                    </div>

                                </div>

                                <!-- DERECHA -->
                                <div class="col-right">

                                    <label for="agOperator">Operador</label>
                                    <input id="agOperator" type="text" readonly="readonly"/>

                                    <label for="opDate">Fecha</label>
                                    <input type="date" id="opDate"/>

                                    <label for="nomSolicitante">Apellidos y Nombres (auto)</label>
                                    <input id="nomSolicitante" type="text"
                                           placeholder="Se completa al escribir el DNI"/>

                                    <label for="nomBeneficiario">Apellidos y Nombres (auto)</label>
                                    <input id="nomBeneficiario" type="text"
                                           placeholder="Se completa al escribir el DNI"/>

                                </div>

                            </div>
                        </div>

                        <!-- Info comisi√≥n -->
                        <div class="card minihelp">
                            <h3>Reglas de comisi√≥n</h3>
                            <ul>
                                <li>‚â§ S/ 100 ‚Üí S/ 1</li>
                                <li>‚â§ S/ 200 ‚Üí S/ 2</li>
                                <li>‚â§ S/ 300 ‚Üí S/ 3</li>
                                <li>‚Ä¶ (S/ 1 por cada S/ 100)</li>
                            </ul>
                            <p class="muted">C√°lculo autom√°tico mientras escribes.</p>
                        </div>
                    </main>

                    <!-- MIS RECIBOS -->
                    <main id="receiptsView" class="hidden">
                        <div class="card">
                            <div class="row between wrap">
                                <h2>Mis recibos</h2>
                                <div class="row gap">
                                    <label>Filtrar por fecha
                                        <input type="date" id="fltDate"/>
                                    </label>

                                    <label>Banco / Red
                                        <select id="fltBank">
                                            <option value="">Todos</option>
                                        </select>
                                    </label>

                                    <button class="btn" id="btnClearFilters">Limpiar filtros</button>
                                </div>
                            </div>

                            <div class="table-wrap">
                                <table id="tblReceipts">
                                    <thead>
                                    <tr>
                                        <th>Banco/Red</th>
                                        <th>Movimiento</th>
                                        <th>Solicitante</th>
                                        <th>Beneficiario</th>
                                        <th>Cuenta</th>
                                        <th>Descripci√≥n</th>
                                        <th>Monto</th>
                                        <th>Comisi√≥n</th>
                                        <th>Total</th>
                                        <th>Fecha</th>
                                        <th>Boleta</th>
                                        <th></th>
                                    </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>

                            <div class="row end">
                                <div class="card total">
                                    Total comisiones del d√≠a:
                                    <strong>S/ <span id="sumFees">0</span></strong>
                                </div>
                            </div>
                        </div>
                    </main>

                </section>

                <!-- jsPDF desde CDN (solo para el PDF de la boleta).
                     Tu script.js se carga v√≠a assets en el manifest. -->
                <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
                <script>
                    window.jsPDF = window.jspdf.jsPDF;
                </script>

            </main>
        </t>
    </template>
</odoo>
